{"version":3,"file":"property-editor-ui-mux-sync.element-CxO4A1Bf.js","sources":["../../../Client/src/api/types.gen.ts","../../../Client/src/api/sdk.gen.ts","../../../Client/src/property-editor-ui-mux-sync.element.ts"],"sourcesContent":["// This file is auto-generated by @hey-api/openapi-ts\n\nexport enum AssetStatus {\n    NOT_FOUND = 'NotFound',\n    UNKNOWN = 'Unknown',\n    PREPARING = 'Preparing',\n    ERRORED = 'Errored',\n    READY = 'Ready'\n}\n\nexport type GetStatusData = {\n    body?: never;\n    path?: never;\n    query?: {\n        assetId?: string;\n    };\n    url: '/umbraco/umux/api/v1/status';\n};\n\nexport type GetStatusErrors = {\n    /**\n     * The resource is protected and requires an authentication token\n     */\n    401: unknown;\n};\n\nexport type GetStatusResponses = {\n    /**\n     * OK\n     */\n    200: AssetStatus;\n};\n\nexport type GetStatusResponse = GetStatusResponses[keyof GetStatusResponses];\n\nexport type ClientOptions = {\n    baseUrl: 'http://localhost:59927' | (string & {});\n};","// This file is auto-generated by @hey-api/openapi-ts\n\nimport type { Options as ClientOptions, TDataShape, Client } from './client';\nimport type { GetStatusData, GetStatusResponses, GetStatusErrors } from './types.gen';\nimport { client as _heyApiClient } from './client.gen';\n\nexport type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = ClientOptions<TData, ThrowOnError> & {\n    /**\n     * You can provide a client instance returned by `createClient()` instead of\n     * individual options. This might be also useful if you want to implement a\n     * custom client.\n     */\n    client?: Client;\n    /**\n     * You can pass arbitrary values through the `meta` object. This can be\n     * used to access values that aren't defined as part of the SDK function.\n     */\n    meta?: Record<string, unknown>;\n};\n\nexport class Umux {\n    public static getStatus<ThrowOnError extends boolean = false>(options?: Options<GetStatusData, ThrowOnError>) {\n        return (options?.client ?? _heyApiClient).get<GetStatusResponses, GetStatusErrors, ThrowOnError>({\n            security: [\n                {\n                    scheme: 'bearer',\n                    type: 'http'\n                }\n            ],\n            url: '/umbraco/umux/api/v1/status',\n            ...options\n        });\n    }\n}","import { html, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport type {\r\n  UmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { MuxValue } from './types/muxvalue';\r\nimport { AssetStatus, Umux } from './api';\r\n\r\n@customElement('umux-property-editor-ui-mux-sync')\r\nexport class uMuxPropertyEditorUIMuxSyncElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\r\n  @property()\r\n  public set value(newValue: MuxValue | undefined | null) {\r\n    this._value = newValue;\r\n    this.#fetchStatus();\r\n  }\r\n  public get value(): MuxValue | undefined | null {\r\n    return this._value;\r\n  }\r\n\r\n  @state()\r\n  private _value: MuxValue | undefined | null = null;\r\n\r\n  @state()\r\n  private _status: AssetStatus | null = null;\r\n\r\n  @state()\r\n  private _statusLoading = false;\r\n\r\n\r\n  #fetchStatus = async () => {\r\n    if (!this.value?.MuxAssetId) {\r\n      this._status = null;\r\n      return;\r\n    }\r\n    this._statusLoading = true;\r\n\r\n    const { data } = await Umux.getStatus({ query: { assetId: this.value.MuxAssetId } });\r\n\r\n    this._statusLoading = false;\r\n    this._status = data as unknown as AssetStatus;\r\n\r\n    if (this._status === AssetStatus.UNKNOWN || this._status === AssetStatus.PREPARING) {\r\n      setTimeout(() => this.#fetchStatus(), 5000);\r\n    }\r\n  }\r\n\r\n  #assetStatusColor = (status: AssetStatus | null) => {\r\n    switch (status) {\r\n      case AssetStatus.PREPARING:\r\n        return 'warning';\r\n      case AssetStatus.ERRORED:\r\n        return 'danger';\r\n      case AssetStatus.READY:\r\n        return 'positive';\r\n      case AssetStatus.NOT_FOUND:\r\n      case AssetStatus.UNKNOWN:\r\n      default:\r\n        return 'default';\r\n    }\r\n  }\r\n\r\n  #assetStatusLabel = (status: AssetStatus | null) => {\r\n    switch (status) {\r\n      case AssetStatus.PREPARING:\r\n        return 'Preparing';\r\n      case AssetStatus.ERRORED:\r\n        return 'Errored';\r\n      case AssetStatus.READY:\r\n        return 'Ready';\r\n      case AssetStatus.NOT_FOUND:\r\n        return 'Not Found';\r\n      case AssetStatus.UNKNOWN:\r\n      default:\r\n        return 'Unknown';\r\n    }\r\n  }\r\n\r\n  override render() {\r\n    return this.value\r\n      ? html`\r\n          <uui-ref-node name=${this.value?.MuxAssetId ?? \"No asset id\"} detail=${this.value?.PlaybackId ?? \"No playback id\"} readonly>\r\n            <uui-icon slot=\"icon\" name=\"icon-video\"></uui-icon>\r\n            ${this._statusLoading\r\n              ? html`<uui-loader size=\"s\" slot=\"tag\"></uui-loader>`\r\n              : html`<uui-tag size=\"s\" slot=\"tag\" color=${this.#assetStatusColor(this._status)} @click=${this.#fetchStatus}>${this.#assetStatusLabel(this._status)}</uui-tag>`\r\n            }\r\n\r\n          </uui-ref-node>\r\n        `\r\n      : html`<uui-tag look=\"placeholder\">No video uploaded to MUX</uui-tag>`\r\n  }\r\n}\r\n\r\nexport default uMuxPropertyEditorUIMuxSyncElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'umux-property-editor-ui-mux-sync': uMuxPropertyEditorUIMuxSyncElement;\r\n  }\r\n}\r\n"],"names":["AssetStatus","Umux","options","_heyApiClient","_fetchStatus","_assetStatusColor","_assetStatusLabel","uMuxPropertyEditorUIMuxSyncElement","UmbLitElement","__privateAdd","_a","data","__privateGet","status","newValue","html","_b","__decorateClass","property","state","customElement","uMuxPropertyEditorUIMuxSyncElement$1"],"mappings":"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"}